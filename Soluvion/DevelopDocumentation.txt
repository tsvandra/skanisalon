================================================================================
PROJEKT DOKUMENTÁCIÓ: SOLUVION (SKANI SALON)
================================================================================
Dátum:   2026.02.06.
Státusz: MVP (Minimum Viable Product) fejlesztés / Stabilizálás alatt

[ CÉL ]
Egy .NET backend alapú, Vue.js frontenddel rendelkezõ webalkalmazás fejlesztése.

- Jelenlegi fázis: Egyedi bemutatkozó oldal + Admin funkciók (CMS) egy adott 
  szalonnak. Éles környezetben (Railway + Netlify) fut.
- Jövõbeli cél: Multi-tenant (SaaS) rendszer, ahol több szalon is használhatja 
  az appot saját adatbázis adatokkal, egyetlen kódbázissal.

--------------------------------------------------------------------------------

[ TECHNOLÓGIAI STACK ]

- Backend:      .NET 10 Web API, Entity Framework Core
- Adatbázis:    PostgreSQL (Railway hostolt)
- Frontend:     Vue 3 (Composition API), Vite, PrimeVue komponensek
- Autentikáció: JWT Token (Bearer auth) + Claims (CompanyId tárolása)
- Hosting:
    > Backend:  Railway (Docker alapú konténer)
    > Frontend: Netlify (Static site hosting SPA konfigurációval)

--------------------------------------------------------------------------------

[ PROJEKT MENEDZSMENT ÉS MUNKAIDÕ KÖVETÉS ]

A fejlesztés során a GitHub beépített eszközeit használjuk "ERP"-ként, 
hogy elkerüljük a külsõ szoftverek használatát (Company Policy miatt).

1. Feladatkezelés (GitHub Projects):
   - Kanban tábla nézet (Board):
     [Backlog] -> [Todo] -> [In Progress] -> [Done]
   - Minden fejlesztési feladat külön Issue-ként kerül rögzítésre.

2. Munkaidõ Adminisztráció:
   - A GitHub Project nézetben létrehoztunk egy egyedi "Munkaora" (Number) mezõt.
   - Folyamat:
     A. Feladat elvégzése után a fejlesztõ beírja az eltöltött órát (pl. 2.5).
     B. A rendszer automatikusan összegzi (Sum) a projekt teljes ráfordítását.
   - Elõny: Transzparens, egy helyen van a kóddal, könnyen exportálható.

--------------------------------------------------------------------------------

[ GIT BRANCHING STRATÉGIA (Feature Branch Workflow) ]

A kód stabilitásának megõrzése érdekében szigorú elágaztatási modellt követünk.

1. Ágak (Branches):
   - main:    (PRODUCTION) Csak a stabil, éles verziót tartalmazza. Ritkán frissül.
   - develop: (STAGING) A központi fejlesztõi ág. A CI/CD rendszerek ezt figyelik.
   - feature: (LOCAL) Ideiglenes ágak egy-egy konkrét feladathoz.

2. Névkonvenció (Összekötés az Issue-kkal):
   A feature ágak neve tartalmazza a GitHub Issue számát a visszakövethetõségért.
   
   Formátum: feature/{issue-id}-{rovid-leiras}
   Példa:    feature/12-arlista-backend

3. Munkafolyamat Lépései:
   A. Kiindulás a develop ágból:
      $ git checkout develop
      $ git pull origin develop

   B. Új funkció ág létrehozása (pl. Issue #12):
      $ git checkout -b feature/12-arlista-backend

   C. Fejlesztés & Commit (Lokálisan):
      $ git add .
      $ git commit -m "Backend modell kesz"

   D. Befejezés & Merge:
      $ git checkout develop
      $ git merge feature/12-arlista-backend
      $ git branch -d feature/12-arlista-backend

   E. Publikálás (Deploy):
      $ git push origin develop  --> Ekkor indul a Netlify/Railway build!

--------------------------------------------------------------------------------

[ ARCHITEKTÚRA ÉS SZABÁLYOK (SaaS Elõkészítés) ]

1. Adatbázis & Multi-tenancy
   - Minden üzleti entitás (Service, Gallery, User, Company) kötelezõen 
     rendelkezik 'CompanyId'-vel.
   - Jelenleg a rendszer a 7-es ID-t (Skani Salon) kezeli teszteléshez.

2. Frontend (Dinamikus Mûködés)
   - Zéró Hardcode: Nem drótozunk be cégnevet, logót vagy színeket.
   - Initialization (App.vue):
     A. Ellenõrzi a localStorage-ban a tokent ('salon_token').
     B. Ha van token -> Dekódolja és lekéri a cégadatokat (/api/Company/{id}).
     C. Ha nincs token -> Látogatói módban indul (publikus adatokkal).
   - Style Injection: A lekért adatok alapján az app valós idõben átállítja 
     a CSS változókat (--primary-color, --secondary-color).

3. Biztonság & API
   - CORS: A Backend engedélyezi a Netlify és Localhost kéréseket.
   - Token Validáció: Minden módosító mûveletnél ellenõrzi a CompanyId-t.
   - Routing: A Controller explicit várja az ID-t az URL-ben (pl. PUT {id}), 
     így elkerülhetõ a 405-ös hiba.

--------------------------------------------------------------------------------

[ EDDIG ELKÉSZÜLT FUNKCIÓK ]

1. Publikus Oldalak (Látogatói nézet)
   - SPA Routing: Megoldva a 'netlify.toml' fájllal (nincs 404 hiba).
   - Home: Dinamikus bemutatkozás.
   - Contact: SQL-bõl töltött cím, telefon, nyitvatartás és Google Maps.

2. Admin Funkciók (Védett útvonalak)
   - Login: JWT token kezelés, automatikus kijelentkeztetés hiba esetén.
   - Cégbeállítások (/beallitasok):
     > PrimeVue TabView felület.
     > Elérhetõségek: Cégnév, Email, Telefon, Cím szerkesztése.
     > Nyitvatartás: HTML alapú szövegdobozok (<br> támogatással).
     > Social & Map: Facebook, Insta, TikTok, Maps URL kezelés.
     > Megjelenés: Color Picker a színekhez (azonnali vizuális frissítés).

3. Backend API Végpontok
   - POST /api/Auth/login
   - GET  /api/Company/{id}
   - PUT  /api/Company/{id}  (Védett)
   - (Implementálás alatt: Gallery és Services végpontok)

--------------------------------------------------------------------------------

[ DESIGN SYSTEM (Szigorúan tartandó!) ]

Technikai Megvalósítás:
CSS Változókat (Variables) használunk, melyeket az adatbázis vezérel.

Színpaletta (Skani Default):
   - Elsõdleges (Arany):         #d4af37
     (Használat: Gombok, Ikonok, Linkek, Kiemelések)
   
   - Másodlagos (Fekete/Szürke): #1a1a1a
     (Használat: Háttérszínek, Footer, Header)
   
   - Logo Brand Szín (KIVÉTEL):  Kék átmenet
     (Használat: KIZÁRÓLAG a logóban!)

UI Irányelvek:
   - Inputok: Teljes szélesség (w-full), fókuszban primary color keret.
   - Gombok: Keret nélkül, primary háttérrel (PrimeVue).

--------------------------------------------------------------------------------

[ FILE STRUKTÚRA ÁTTEKINTÉS ]

Soluvion/ (Gyökér)
  +-- Soluvion.API/              (Backend - C#)
  |     +-- Controllers/
  |     +-- Models/
  |     +-- Program.cs
  |
  +-- soluvion-web/              (Frontend - Vue)
        +-- src/
        |     +-- views/         (Home, Settings, Login)
        |     +-- components/    (Header, Footer)
        |     +-- services/      (api.js)
        |     +-- App.vue
        |
        +-- netlify.toml         (SPA Redirect Config - FONTOS!)
        +-- vite-env.d.ts

--------------------------------------------------------------------------------

[ FEJLESZTÉSI WORKFLOW (Best Practice) ]

A Netlify kredit spórolása és a gyors hibajavítás érdekében:

1. Helyi Fejlesztés (Localhost - AJÁNLOTT):
   - Frontend parancs: "npm run dev" (saját gépen).
   - Backend kapcsolat: A .env fájlban az ÉLES Railway URL legyen beállítva.
     (VITE_API_URL=https://skanisalon-production...)
   - Elõny: Valós adatbázis, de azonnali frissítés, nincs build idõ.

2. Deploy (Netlify):
   - Csak akkor tolunk "git push"-t, ha lokálisan minden mûködik.
   - Ha csak mentünk, de nem akarunk buildet: "[skip ci]" a commit üzenetben.

--------------------------------------------------------------------------------

[2026-02-09] ServicesView Refactoring & Drag-and-Drop (Front Office)
- FE: vuedraggable implementálása a szolgáltatások és kategóriák rendezéséhez.
- FE: ServicesView átalakítása sötét témára (Dark Mode), clean UI elvek alapján.
- FE: Hierarchikus adatkezelés (Kategória -> Service -> Variant).
- BE: Service modell bõvítése 'Description' mezõvel (Megjegyzésekhez).
- BE: ServiceController.PutService javítása (Category és Description mentés, Null check).
- UX: 'Race Condition' hiba azonosítva a gyors adatbevitelkor (Javítás a következõ sprintben: refreshLocal logika).
- UX HIBAJAVÍTÁS: 'Race Condition' hiba javítva "Request Queue" (Promise Chain) bevezetésével.
- UI: Vendég nézetben a kategóriák arany színû kiemelést kaptak.
- STATUS: Feature #12 Befejezve -> Merge develop ágra.

--------------------------------------------------------------------------------

*** BEFEJEZVE - FEATURE 13: SMART GALLERY & CLOUDINARY ***
Dátum: 2026-02-09
Státusz: Kész

Backend Változtatások:
- Cloudinary API integrálása a skálázható, felhő alapú képtároláshoz (a helyi fájltárolás kivezetésre került).
- GalleryCategory modell frissítése: 'OrderIndex' mező hozzáadása a kategóriák manuális sorrendezéséhez.
- GalleryImage modell frissítése: 'OrderIndex' és 'PublicId' (Cloudinary törléshez) mezők hozzáadása.
- GalleryController refaktorálása: 
  - Új "Okos végpontok" a kategória kezeléshez (Létrehozás, Átnevezés, Sorrendezés, Törlés).
  - Védelmi logika implementálása: Nem üres kategória nem törölhető.
  - GET lekérdezések optimalizálása: Hierarchikus szerkezet visszaadása (Kategóriák + Képek).

Frontend Változtatások (GalleryView.vue):
- "Nested Drag-and-Drop" implementálása:
  - A felhasználók sorrendezhetik a kategóriákat (függőleges lista).
  - A felhasználók sorrendezhetik a képeket a kategóriákon belül.
  - A képek áthúzhatók egyik kategóriából a másikba.
- "Inline" Kategória Létrehozás: Az új galériák azonnal megjelennek a lista tetején, és a név mező automatikusan fókuszt kap.
- "Kontextuális Feltöltés": A feltöltés gomb átkerült a kategória fejlécekbe, így egyértelmű, hova töltünk fel.
- UI/UX Finomhangolás: 
  - Egységes négyzetes képarány (thumbnail).
  - Lightbox (nagyítás) funkció a képek megtekintéséhez.
  - Töltési állapotok és optimista UI frissítések.

Refactoring / Clean Code:
- Létrehozva: `src/composables/useAutoSaveQueue.js`: A mentési sor (queue) logika kiszervezése, hogy újrahasznosítható legyen az alkalmazásban (DRY elv).
- DTO-k kiszervezése külön fájlokba a Backend oldalon.

--------------------------------------------------------------------------------

*** BEFEJEZVE - FEATURE 14: ARCULAT KEZELÉS & BEÁLLÍTÁSOK REFAKTOR ***
Dátum: 2026-02-10
Státusz: Kész

Áttekintés:
"White Label" képességek implementálása: az adminisztrátorok testreszabhatják a szalon arculatát (Logó, Lábléc háttérkép, Színek, Méretezés) egy dedikált Beállítások felületen.

Backend Változtatások (CompanyController & Models):
- Company modell bővítése: `LogoUrl`, `LogoHeight`, `FooterImageUrl`, `FooterHeight` mezők hozzáadása.
- Dedikált végpontok létrehozása: `POST /api/Company/upload/logo` és `POST /api/Company/upload/footer` a Cloudinary feltöltéshez és a régi képek törléséhez.
- `PUT /api/Company/{id}` frissítése a dizájn paraméterek (méretek, színek) kezelésére.

Frontend Változtatások (SettingsView & Komponensek):
- SettingsView.vue refaktorálása:
  - PrimeVue `TabView` bevezetése a jobb átláthatóságért (Alapadatok / Megjelenés fülek).
  - Valós idejű csúszkák (slider) a Logó és Lábléc magasságának állításához.
  - Fájlfeltöltők integrálása az arculati elemekhez.
- AppHeader.vue & TheFooter.vue frissítése:
  - A szerkesztő eszközök (gombok, inputok) eltávolítása a megjelenítő komponensekből ("Separation of Concerns").
  - A komponensek mostantól "buta" megjelenítők, amelyek a globális state változásaira reagálnak.
- TheFooter.vue létrehozása: Új komponens a testreszabható lábléc háttér és magasság kezelésére.

UX Döntések:
- A dizájn vezérlők átmozgatása a "Beállítások" menübe, elkerülve a véletlen módosításokat a napi használat során.
- Valós idejű előnézet: A Beállításokban húzott csúszkák azonnal frissítik a Fejlécet/Láblécet a reaktív state injektáláson keresztül.

================================================================================